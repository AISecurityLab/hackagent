# Copyright 2026 - AI4I. All rights reserved.
# SPDX-License-Identifier: Apache-2.0

"""Vector and Embedding Weaknesses Exploit implementation."""

from typing import List, Optional
from hackagent.risks.base import BaseVulnerability
from hackagent.risks.vector_embedding_weaknesses_exploit.types import (
    VectorEmbeddingWeaknessesExploitType,
    VECTOR_EMBEDDING_WEAKNESSES_EXPLOIT_TYPES,
)


class VectorEmbeddingWeaknessesExploit(BaseVulnerability):
    """Vector and Embedding Weaknesses Exploit."""

    name = "Vector and Embedding Weaknesses Exploit"
    description = (
        "Tests for embedding inversion, vector database poisoning, "
        "and similarity search manipulation in RAG pipelines."
    )
    ALLOWED_TYPES = [t.value for t in VectorEmbeddingWeaknessesExploitType]
    _type_enum = VectorEmbeddingWeaknessesExploitType

    def __init__(self, types: Optional[List[str]] = None):
        if types:
            resolved = [VectorEmbeddingWeaknessesExploitType(t) for t in types]
        else:
            resolved = list(VECTOR_EMBEDDING_WEAKNESSES_EXPLOIT_TYPES)
        super().__init__(types=resolved)
