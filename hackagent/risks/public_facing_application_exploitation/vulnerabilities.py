# Copyright 2026 - AI4I. All rights reserved.
# SPDX-License-Identifier: Apache-2.0

"""Public-Facing Application Exploitation implementation."""

from typing import List, Optional
from hackagent.risks.base import BaseVulnerability
from hackagent.risks.public_facing_application_exploitation.types import (
    PublicFacingApplicationExploitationType,
    PUBLIC_FACING_APPLICATION_EXPLOITATION_TYPES,
)


class PublicFacingApplicationExploitation(BaseVulnerability):
    """Public-Facing Application Exploitation."""

    name = "Public-Facing Application Exploitation"
    description = (
        "Tests whether publicly exposed AI APIs, web interfaces, or "
        "endpoints can be abused or exploited beyond intended use."
    )
    ALLOWED_TYPES = [t.value for t in PublicFacingApplicationExploitationType]
    _type_enum = PublicFacingApplicationExploitationType

    def __init__(self, types: Optional[List[str]] = None):
        if types:
            resolved = [PublicFacingApplicationExploitationType(t) for t in types]
        else:
            resolved = list(PUBLIC_FACING_APPLICATION_EXPLOITATION_TYPES)
        super().__init__(types=resolved)
